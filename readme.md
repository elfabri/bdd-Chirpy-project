# The Chirpy Project

Following along the [boot.dev](https://www.boot.dev) course about [http servers with go](https://www.boot.dev/courses/learn-http-servers-golang).

## Features
- Create users and validate their IDs with JWT and refresh tokens
- Optional query to sort chirps
- Query to get chirps from an specific author ID

## Installation

This project is written in **Go**, and uses **Postgres** as the database. You will need go v1.22+ and Postgres v14.15+.
Additionally, **Goose** is used to create, drop and update the tables. The sql queries are generated by **sqlc**.

To set up the project locally, follow these steps:

1. **Clone the repository:**
    ```sh
    git clone https://github.com/elfabri/bdd-Chirpy-project.git
    cd bdd-Chirpy-project
    ```

2. **Install dependencies:**
    ```sh
    go mod tidy
    ```

3. **Goose**
    Go to the sql/schema/ and run the migrations with goose
    ```sh
    goose postgres "<yourDB_URL>" up
    ```

4. **Set up your environment:**
    Configure your environment variables in a .env file on the root of the project.

    You will need to define:

    - DB_URL: the connection link to your database

    - SECRET: a random key to validate JWTs (you can create one with openssl)

    - POLKA_KEY: given by boot dot dev, you can use whatever since is just a local string check

    - PLATFORM: just used to delete users when receiving a post request at "/admin/reset", value: "dev"

    Polka simulates a third party service of payment, in order to check the users subscription to "chirpy-red", a premium and exclusive membership ultra expensive.

## Running the Project

To run the HTTP server, use
    ```sh
    go run .
    ```
at the root of the project. You could also build and run the binary with

```sh
go build -o out main.go
./out
```

## Things you can do
While you have this bad boy running, you may use **curl** and **jq** to make http requests to:
- Create User

```sh
curl -X POST -H "Content-Type: application/json" -d '{"email":<niceEmailHere>, "password":<nicePassWHere>}' http://localhost:8080/api/users | jq .
```

- Login
This will let you write some chirps with the given user

```sh
curl -X POST -H "Content-Type: application/json" -d '{"email":<niceEmailHere>, "password":<samePassWHere>}' http://localhost:8080/api/login | jq .
```

- Write Chirp 

```sh
curl -X POST -H "Content-Type: application/json" -H "Authorization: Bearer <CrazyLongToken>"  -d '{"body":"I Use Nvim, with Fornax tmux btw", "user_id":<theUserIDwithWhichYouLoggedIn>}' http://localhost:8080/api/chirps | jq .
```

In the Chirp App, we have decided to **censor** some "profane" words such as "fornax", the response to this request will be the body and some other information of the chirp, where in the body, fornax will be shown as ****.

- Update User

Update user's email and/or password

```sh
curl -X PUT -H "Content-Type: application/json" -H "Authorization: Bearer <CrazyLongToken>"  -d '{"email":<Email>, "password":<BetterPassW>}' http://localhost:8080/api/users | jq .
```

- Show the chirps

On your browser, you could go to 

 * localhost:8080/api/chirps  -> to show all the chirps

 * localhost:8080/api/chirps/<chirp-id>  -> to show the chirp with id="chirp-id"

 * localhost:8080/api/chirps?author_id=<user-id>  -> to show all the chirps from the user with id="user-id"

 * localhost:8080/api/chirps?sort=desc  -> to show all the chirps, new chirps first 

 * localhost:8080/api/chirps?sort=asc  -> to show all the chirps, older chirps first, this is the default

You could also use **curl**

```sh
curl -X GET -H "Content-Type: application/json" http://localhost:8080/api/chirps | jq .
```

Specific chirp, you just need the chirp's id and use it as:

```sh
curl -X GET -H "Content-Type: application/json" http://localhost:8080/api/chirps/<the-chirp-id> | jq .
```

Chirps from certain author:

```sh
curl -X GET -H "Content-Type: application/json" http://localhost:8080/api/chirps?author_id=<some-user-id> | jq .
```

## Conclusions
I really enjoyed this course. I might try some front-end work, but I will most likely continue to the next course, which is about CDNs.

